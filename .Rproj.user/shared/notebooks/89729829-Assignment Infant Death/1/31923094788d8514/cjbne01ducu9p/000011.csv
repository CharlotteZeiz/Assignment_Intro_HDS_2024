"0","library(dplyr)"
"0","get_mode <- function(x) {"
"0","  uniq_x <- unique(x)"
"0","  uniq_x[which.max(tabulate(match(x, uniq_x)))]}"
"0",""
"0","# Combine council area, mortality rates and rural-urban classification"
"0",""
"0","combined_mortalityallgeo_rural6fold <- mortality_allgeo %>%"
"0","  inner_join(`CA_rural6fold`, by = c(""area_code"" = ""CA"")) %>% "
"0","  select(area_type, area_name, year, mortality_rate, classification)"
"2","Warning: Detected an unexpected many-to-many relationship between `x` and `y`."
"0","#summarise mortality and classification per area_name and year "
"0","AVG_6_mort_class_percouncil_peryear <- combined_mortalityallgeo_rural6fold %>%"
"0","  group_by(area_name, year) %>% "
"0","  summarise("
"0","    avg_mortality_rate = mean(mortality_rate, na.rm = TRUE),"
"0","    mode_classification = get_mode(classification) #mode for whole numbers of original categories"
"0","  )"
"0",""
"0","#create classification categories via mode according to scot public health"
"0"," group_classification <- AVG_6_mort_class_percouncil_peryear %>% "
"0","  mutate(mode_classification = case_when("
"0","    mode_classification == 1 ~ ""Large Urban Areas"","
"0","    mode_classification == 2 ~ ""Other Urban Areas"","
"0","    mode_classification == 3 ~ ""Accessible Small Towns"","
"0","    mode_classification == 4 ~ ""Remote Small Towns"","
"0","    mode_classification == 5 ~ ""Accessible Rural"","
"0","    mode_classification == 6 ~ ""Remote Rural"","
"0","    TRUE ~ ""Unknown"""
"0","  ))"
"0",""
"0","# average mortality rate per classification"
"0","avg_6class_mort_year <- AVG_6_mort_class_percouncil_peryear %>%"
"0","  select(`year`,`avg_mortality_rate`, `mode_classification`) %>%"
"0","  group_by(mode_classification, year) %>%"
"0","  summarise(AVG_mortality_rate = mean(avg_mortality_rate, na.rm = TRUE))"
"0",""
"0","#r Perform Kruskal-Wallis test for 3 and 6 fold, include=FALSE}"
"0","kruskal_test_result <- kruskal.test(AVG_mortality_rate ~ mode_classification, data = avg_6class_mort_year)"
"0","kruskal_test_result"
"1","
"
"1","	Kruskal-Wallis rank sum test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","AVG_mortality_rate by mode_classification"
"1",""
"1","
"
"1","Kruskal-Wallis chi-squared = 13.619, df = 4, p-value = 0.008616"
"1","
"
"1","
"
"0","# -->continue with the 6-fold dataset"
